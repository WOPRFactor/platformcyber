/**
 * Tipos para el módulo de evaluación de vulnerabilidades
 */

export interface VulnSession {
  id: string
  target: string
  tool: string
  status: 'running' | 'completed' | 'failed' | 'stopped'
  start_time: string
  end_time?: string
  results?: VulnResult[]
  progress?: number
  error?: string
}

export interface VulnResult {
  id: string
  session_id: string
  severity: 'low' | 'medium' | 'high' | 'critical'
  title: string
  description: string
  cve?: string
  cvss_score?: number
  affected_url?: string
  parameter?: string
  evidence?: string
  recommendation?: string
  tool: string
  timestamp: string
}

export interface VulnScanRequest {
  target: string
  tool: 'nikto' | 'sqlmap' | 'dirb' | 'gobuster'
  options?: Record<string, any>
}

export interface VulnScanResponse {
  session_id: string
  message: string
  status: 'started'
}

export interface NiktoResult extends VulnResult {
  tool: 'nikto'
  port?: number
  banner?: string
  osvdb?: string
}

export interface SqlMapResult extends VulnResult {
  tool: 'sqlmap'
  dbms?: string
  payload?: string
  technique?: string
}

export interface DirbResult extends VulnResult {
  tool: 'dirb'
  url: string
  status_code: number
  size?: number
}

export interface GobusterResult extends VulnResult {
  tool: 'gobuster'
  url: string
  status_code: number
  content_length?: number
}

export interface VulnSessionsResponse {
  sessions: VulnSession[]
  total: number
}

export interface VulnResultsResponse {
  results: VulnResult[]
  total: number
  session_id: string
}



