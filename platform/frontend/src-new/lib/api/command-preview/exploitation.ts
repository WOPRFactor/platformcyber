/**
 * Exploitation Command Previews
 * =============================
 * 
 * Previews de comandos de explotaci√≥n.
 */

import { api } from '../shared/client'
import { PreviewRequest, CommandPreviewResponse } from './types'

export const exploitationPreviews = {
  previewHydra: async (params: PreviewRequest & {
    target: string
    service: string
    username?: string
    userfile?: string
    password?: string
    passfile?: string
    port?: number
    threads?: number
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/hydra/preview',
      params
    )
    return response.data
  },

  previewJohn: async (params: PreviewRequest & {
    hash_file: string
    wordlist?: string
    format?: string
    rules?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/john/preview',
      params
    )
    return response.data
  },

  previewHashcat: async (params: PreviewRequest & {
    hash_file: string
    hash_type: string
    wordlist?: string
    rules_file?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/hashcat/preview',
      params
    )
    return response.data
  },

  previewKerbrute: async (params: PreviewRequest & {
    target: string
    userlist?: string
    password?: string
    passwordlist?: string
    domain?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/kerbrute/preview',
      params
    )
    return response.data
  },

  previewCrackMapExec: async (params: PreviewRequest & {
    targets: string
    protocol: string
    username?: string
    password?: string
    hash?: string
    domain?: string
    command?: string
    shares?: boolean
    pass_pol?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/crackmapexec/preview',
      params
    )
    return response.data
  },

  previewResponder: async (params: PreviewRequest & {
    interface: string
    lm?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/responder/preview',
      params
    )
    return response.data
  },

  previewImpacketPsexec: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    command?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/impacket/psexec/preview',
      params
    )
    return response.data
  },

  previewImpacketWmiexec: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    command?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/impacket/wmiexec/preview',
      params
    )
    return response.data
  },

  previewImpacketSmbexec: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    command?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/impacket/smbexec/preview',
      params
    )
    return response.data
  },

  previewImpacketSecretsdump: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    just_dc?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/impacket/secretsdump/preview',
      params
    )
    return response.data
  },

  previewImpacketGetUserSPNs: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain: string
    hash?: string
    request?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/impacket/getuserspns/preview',
      params
    )
    return response.data
  },

  previewImpacketGetNPUsers: async (params: PreviewRequest & {
    target: string
    domain: string
    users_file?: string
    no_pass?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/impacket/getnpusers/preview',
      params
    )
    return response.data
  },

  previewEvilWinRM: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    hash?: string
    ssl?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/evilwinrm/preview',
      params
    )
    return response.data
  },

  previewMsfvenom: async (params: PreviewRequest & {
    payload_type: string
    lhost: string
    lport: number
    format?: string
    encoder?: string
    iterations?: number
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/msfvenom/preview',
      params
    )
    return response.data
  },

  previewMetasploitHandler: async (params: PreviewRequest & {
    payload: string
    lhost: string
    lport: number
    exit_on_session?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'exploitation/metasploit-handler/preview',
      params
    )
    return response.data
  }
}


