/**
 * Vulnerability Command Previews
 * ===============================
 * 
 * Previews de comandos de evaluaci√≥n de vulnerabilidades.
 */

import { api } from '../shared/client'
import { PreviewRequest, CommandPreviewResponse } from './types'

export const vulnerabilityPreviews = {
  previewNucleiScan: async (params: PreviewRequest & {
    target: string
    severity?: string[]
    tags?: string[]
    templates?: string
    rate_limit?: number
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/nuclei/preview',
      params
    )
    return response.data
  },

  // Alias para compatibilidad
  previewNuclei: async (params: PreviewRequest & {
    target: string
    severity?: string[]
    tags?: string[]
    templates?: string
    rate_limit?: number
  }): Promise<CommandPreviewResponse> => {
    return vulnerabilityPreviews.previewNucleiScan(params)
  },

  previewNiktoScan: async (params: PreviewRequest & {
    target: string
    port?: number
    ssl?: boolean
    tuning?: string
    maxtime?: string | number
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/nikto/preview',
      params
    )
    return response.data
  },

  previewSQLMap: async (params: PreviewRequest & {
    url: string
    data?: string
    method?: string
    level?: number
    risk?: number
    techniques?: string[]
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/sqlmap/preview',
      params
    )
    return response.data
  },

  // Alias para compatibilidad
  previewSqlmap: async (params: PreviewRequest & {
    url: string
    data?: string
    method?: string
    level?: number
    risk?: number
    techniques?: string[]
  }): Promise<CommandPreviewResponse> => {
    return vulnerabilityPreviews.previewSQLMap(params)
  },

  previewZAP: async (params: PreviewRequest & {
    target: string
    scan_type?: string
    context?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/zap/preview',
      params
    )
    return response.data
  },

  // Alias para compatibilidad
  previewZap: async (params: PreviewRequest & {
    target: string
    scan_type?: string
    context?: string
  }): Promise<CommandPreviewResponse> => {
    return vulnerabilityPreviews.previewZAP(params)
  },

  previewTestSSL: async (params: PreviewRequest & {
    target: string
    port?: number
    full?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/testssl/preview',
      params
    )
    return response.data
  },

  // Alias para compatibilidad
  previewTestssl: async (params: PreviewRequest & {
    target: string
    port?: number
    full?: boolean
  }): Promise<CommandPreviewResponse> => {
    return vulnerabilityPreviews.previewTestSSL(params)
  },

  previewWhatWeb: async (params: PreviewRequest & {
    target: string
    aggression?: number
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/whatweb/preview',
      params
    )
    return response.data
  },

  // Alias para compatibilidad
  previewWhatweb: async (params: PreviewRequest & {
    target: string
    aggression?: number
  }): Promise<CommandPreviewResponse> => {
    return vulnerabilityPreviews.previewWhatWeb(params)
  },

  previewWPScan: async (params: PreviewRequest & {
    target: string
    enumerate?: string[]
    plugins?: string[]
    themes?: string[]
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/wpscan/preview',
      params
    )
    return response.data
  },

  // Alias para compatibilidad
  previewWpscan: async (params: PreviewRequest & {
    target: string
    enumerate?: string[]
    plugins?: string[]
    themes?: string[]
  }): Promise<CommandPreviewResponse> => {
    return vulnerabilityPreviews.previewWPScan(params)
  },

  previewNmapVuln: async (params: PreviewRequest & {
    target: string
    ports?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/nmap-vuln/preview',
      params
    )
    return response.data
  },

  previewDalfox: async (params: PreviewRequest & {
    target: string
    blind?: string
    custom_alert?: string
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/dalfox/preview',
      params
    )
    return response.data
  },

  previewComprehensive: async (params: PreviewRequest & {
    target: string
    include_nikto?: boolean
    include_nmap?: boolean
    include_nuclei?: boolean
  }): Promise<CommandPreviewResponse> => {
    const response = await api.post<CommandPreviewResponse>(
      'vulnerability/comprehensive/preview',
      params
    )
    return response.data
  }
}

