/**
 * Tipos para el módulo de explotación (Exploitation)
 */

export interface ExploitResult {
  success: boolean
  target?: string
  url?: string
  port?: number
  exploit_type: string
  methods_tested?: number
  payloads_tested?: number
  results?: any[]
  payload?: string
  payload_length?: number
  recommendation?: string
  error?: string
}

export interface ComprehensiveExploitResult {
  target: string
  timestamp: string
  phases: {
    rce?: ExploitResult
    sql_injection?: ExploitResult
    command_injection?: ExploitResult
    file_inclusion?: ExploitResult
    deserialization?: ExploitResult
    buffer_overflow?: ExploitResult
  }
  summary: {
    total_phases: number
    successful_phases: number
    failed_phases: number
    exploit_types_tested: string[]
    recommendation: string
  }
}

export interface ExploitSession {
  id: number
  session_id: string
  target: string
  scan_type: string
  created_at: string
  status: string
}

export interface PayloadGenerationRequest {
  target_os: string
  payload_type: string
  lhost: string
  lport: string
  format?: string
  options?: Record<string, any>
}

export interface PayloadGenerationResponse {
  payload: string
  payload_length: number
  format: string
  instructions: string
  warning?: string
}

export interface ExploitRequest {
  target: string
  exploit_type: 'rce' | 'sql_injection' | 'command_injection' | 'file_inclusion' | 'deserialization' | 'buffer_overflow'
  url?: string
  port?: number
  parameters?: Record<string, any>
}

export interface ExploitResponse {
  session_id: string
  message: string
  status: 'started'
}

export interface ExploitSessionsResponse {
  sessions: ExploitSession[]
  total: number
}

export interface ExploitResultsResponse {
  results: ExploitResult[]
  session_id: string
  total: number
}



