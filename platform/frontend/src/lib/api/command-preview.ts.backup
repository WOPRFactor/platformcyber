/**
 * Command Preview API Client
 * ===========================
 * 
 * Cliente para obtener previews de comandos antes de ejecutarlos.
 */

import { api } from './shared/client'
import { CommandPreview } from '../../components/CommandPreviewModal'

export interface PreviewRequest {
  workspace_id: number
  [key: string]: any
}

export const commandPreviewAPI = {
  /**
   * Preview de comando de enumeraci√≥n de subdominios
   */
  previewSubdomainEnum: async (params: PreviewRequest & {
    domain: string
    tool?: string
    passive_only?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/subdomains/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Nmap
   */
  previewNmapScan: async (params: PreviewRequest & {
    target: string
    scan_type?: string
    ports?: string
    scripts?: string[]
    os_detection?: boolean
    version_detection?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/nmap/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Nuclei
   */
  previewNucleiScan: async (params: PreviewRequest & {
    target: string
    severity?: string[]
    tags?: string[]
    templates?: string
    rate_limit?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/nuclei/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Nikto
   */
  previewNiktoScan: async (params: PreviewRequest & {
    target: string
    port?: number
    ssl?: boolean
    tuning?: string
    maxtime?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/nikto/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando WHOIS
   */
  previewWhois: async (params: PreviewRequest & {
    target: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/whois/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando DNS Recon
   */
  previewDnsRecon: async (params: PreviewRequest & {
    domain: string
    record_types?: string[]
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/dns/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Findomain
   */
  previewFindomain: async (params: PreviewRequest & {
    domain: string
    resolvers_file?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/findomain/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando crt.sh
   */
  previewCrtsh: async (params: PreviewRequest & {
    domain: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/crtsh/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando DNS Lookup
   */
  previewDnsLookup: async (params: PreviewRequest & {
    domain: string
    tool?: string
    record_type?: string
    dns_server?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/dns-lookup/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando DNS Enum Alt
   */
  previewDnsEnumAlt: async (params: PreviewRequest & {
    domain: string
    tool?: string
    wordlist?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/dns-enum-alt/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Traceroute
   */
  previewTraceroute: async (params: PreviewRequest & {
    target: string
    protocol?: string
    max_hops?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/traceroute/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Hunter.io
   */
  previewHunterIo: async (params: PreviewRequest & {
    domain: string
    api_key?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/hunter-io/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando LinkedIn Enum
   */
  previewLinkedInEnum: async (params: PreviewRequest & {
    domain: string
    company_name?: string
    tool?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/linkedin-enum/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Email Harvesting
   */
  previewEmailHarvest: async (params: PreviewRequest & {
    domain: string
    sources?: string
    limit?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/emails/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Web Crawling
   */
  previewWebCrawl: async (params: PreviewRequest & {
    url: string
    tool?: string
    depth?: number
    scope?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/webcrawl/crawl/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Shodan
   */
  previewShodan: async (params: PreviewRequest & {
    query: string
    api_key?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/osint/shodan/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Censys
   */
  previewCensys: async (params: PreviewRequest & {
    query: string
    index_type?: string
    api_id?: string
    api_secret?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/osint/censys/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Wayback URLs
   */
  previewWayback: async (params: PreviewRequest & {
    domain: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/osint/wayback/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Secrets Detection
   */
  previewSecrets: async (params: PreviewRequest & {
    repo_url: string
    tool?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/secrets/secrets/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Google Dorks
   */
  previewGoogleDorks: async (params: PreviewRequest & {
    domain: string
    dork_query?: string
    tool?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'reconnaissance/googledorks/google-dorks/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando RustScan
   */
  previewRustscan: async (params: PreviewRequest & {
    target: string
    batch_size?: number
    timeout?: number
    ulimit?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/rustscan/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Masscan
   */
  previewMasscan: async (params: PreviewRequest & {
    target: string
    ports?: string
    rate?: number
    environment?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/masscan/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Naabu
   */
  previewNaabu: async (params: PreviewRequest & {
    target: string
    top_ports?: number
    rate?: number
    verify?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/naabu/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando SQLMap
   */
  previewSqlmap: async (params: PreviewRequest & {
    target: string
    method?: string
    data?: string
    level?: number
    risk?: number
    techniques?: string[]
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/sqlmap/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando ZAP
   */
  previewZap: async (params: PreviewRequest & {
    target: string
    scan_type?: string
    context?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/zap/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando testssl
   */
  previewTestssl: async (params: PreviewRequest & {
    target: string
    severity?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/testssl/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando WhatWeb
   */
  previewWhatweb: async (params: PreviewRequest & {
    target: string
    aggression?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/whatweb/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Dalfox
   */
  previewDalfox: async (params: PreviewRequest & {
    target: string
    blind?: boolean
    worker?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/dalfox/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Nmap Vulnerability Scripts
   */
  previewNmapVuln: async (params: PreviewRequest & {
    target: string
    ports?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/nmap-vuln/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Comprehensive Vulnerability Assessment
   */
  previewComprehensive: async (params: PreviewRequest & {
    target: string
    include_nikto?: boolean
    include_nmap?: boolean
    include_nuclei?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/comprehensive/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando WPScan
   */
  previewWpscan: async (params: PreviewRequest & {
    target: string
    enumerate?: string
    plugins_detection?: string
    api_token?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'vulnerability/wpscan/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Hydra
   */
  previewHydra: async (params: PreviewRequest & {
    target: string
    service: string
    username?: string
    userfile?: string
    password?: string
    passfile?: string
    port?: number
    threads?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/hydra/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando John the Ripper
   */
  previewJohn: async (params: PreviewRequest & {
    hash_file: string
    wordlist?: string
    format?: string
    rules?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/john/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Hashcat
   */
  previewHashcat: async (params: PreviewRequest & {
    hash_file: string
    mode: number
    wordlist: string
    rules_file?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/hashcat/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Kerbrute
   */
  previewKerbrute: async (params: PreviewRequest & {
    domain: string
    mode: string
    users_file?: string
    passwords_file?: string
    password?: string
    dc_ip?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/kerbrute/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando CrackMapExec
   */
  previewCrackMapExec: async (params: PreviewRequest & {
    targets: string
    protocol: string
    username?: string
    password?: string
    hash?: string
    domain?: string
    command?: string
    shares?: boolean
    pass_pol?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/crackmapexec/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Responder
   */
  previewResponder: async (params: PreviewRequest & {
    interface: string
    lm?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/responder/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Impacket psexec
   */
  previewImpacketPsexec: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    command?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/impacket/psexec/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Impacket wmiexec
   */
  previewImpacketWmiexec: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    command?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/impacket/wmiexec/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Impacket smbexec
   */
  previewImpacketSmbexec: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    command?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/impacket/smbexec/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Impacket secretsdump
   */
  previewImpacketSecretsdump: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain?: string
    hash?: string
    just_dc?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/impacket/secretsdump/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Impacket GetUserSPNs
   */
  previewImpacketGetUserSPNs: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    domain: string
    hash?: string
    request?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/impacket/getuserspns/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Impacket GetNPUsers
   */
  previewImpacketGetNPUsers: async (params: PreviewRequest & {
    target: string
    domain: string
    users_file?: string
    no_pass?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/impacket/getnpusers/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Evil-WinRM
   */
  previewEvilWinRM: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    hash?: string
    ssl?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/evilwinrm/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando msfvenom
   */
  previewMsfvenom: async (params: PreviewRequest & {
    payload_type: string
    lhost: string
    lport: number
    format?: string
    encoder?: string
    iterations?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/msfvenom/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de comando Metasploit Handler
   */
  previewMetasploitHandler: async (params: PreviewRequest & {
    payload: string
    lhost: string
    lport: number
    exit_on_session?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'exploitation/metasploit-handler/preview',
      params
    )
    return response.data
  },

  // ============================================
  // POST-EXPLOITATION PREVIEWS
  // ============================================

  /**
   * Preview de LinPEAS
   */
  previewLinPEAS: async (params: PreviewRequest & {
    local: boolean
    target?: string
    ssh_user?: string
    ssh_pass?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/linpeas/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de WinPEAS
   */
  previewWinPEAS: async (params: PreviewRequest & {
    target: string
    local: boolean
    username?: string
    password?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/winpeas/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de Mimikatz
   */
  previewMimikatz: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    command?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/mimikatz/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de Seatbelt
   */
  previewSeatbelt: async (params: PreviewRequest & {
    target: string
    username: string
    password: string
    group?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/seatbelt/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de SSH Pivot
   */
  previewSSHPivot: async (params: PreviewRequest & {
    jump_host: string
    jump_user: string
    remote_host: string
    remote_port: number
    local_port: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/ssh-pivot/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de Chisel
   */
  previewChisel: async (params: PreviewRequest & {
    attacker_host: string
    attacker_port: number
    remote_host: string
    remote_port: number
    bind_port: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/chisel/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de Ligolo
   */
  previewLigolo: async (params: PreviewRequest & {
    relay_port: number
    agent_port: number
    target_subnet: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'post-exploitation/ligolo/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de FTP Enum
   */
  previewFtpEnum: async (params: PreviewRequest & {
    target: string
    port?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/enum/ftp/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de DNS Enum
   */
  previewDnsEnum: async (params: PreviewRequest & {
    target: string
    domain?: string
    tool?: string
    port?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/enum/dns/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de RDP Enum
   */
  previewRdpEnum: async (params: PreviewRequest & {
    target: string
    port?: number
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/enum/rdp/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de enum4linux
   */
  previewEnum4linux: async (params: PreviewRequest & {
    target: string
    use_ng?: boolean
    all?: boolean
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/enum/smb/enum4linux/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de smbmap
   */
  previewSmbmap: async (params: PreviewRequest & {
    target: string
    username?: string
    password?: string
    hash?: string
    recursive?: boolean
    share?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/enum/smb/smbmap/preview',
      params
    )
    return response.data
  },

  /**
   * Preview de smbclient
   */
  previewSmbclient: async (params: PreviewRequest & {
    target: string
    share?: string
    username?: string
    password?: string
    command?: string
  }): Promise<CommandPreview> => {
    const response = await api.post<CommandPreview>(
      'scanning/enum/smb/smbclient/preview',
      params
    )
    return response.data
  },
}

