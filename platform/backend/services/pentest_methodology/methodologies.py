"""
Methodologies Data
==================

Datos de metodologías de pentesting predefinidas.
"""

from typing import Dict, Any


def get_methodologies() -> Dict[str, Dict[str, Any]]:
    """Obtener todas las metodologías predefinidas"""
    return {
        "black_box": {
            "name": "Caja Negra (Black Box)",
            "description": "Prueba sin conocimiento previo del sistema objetivo. Simula un ataque externo real.",
            "scope": "Sin acceso al código fuente, arquitectura o credenciales. Solo información pública.",
            "access_level": "Ninguno - Solo perspectiva externa",
            "estimated_time": "2-4 semanas",
            "difficulty": "media",
            "phases": [
                "reconnaissance",
                "scanning",
                "enumeration",
                "vulnerability_assessment",
                "exploitation",
                "post_exploitation",
                "reporting"
            ],
            "tools": [
                "Nmap", "Masscan", "Rustscan", "Naabu",
                "theHarvester", "Sublist3r", "Amass",
                "Nikto", "Nuclei", "WPScan",
                "SQLMap", "XSStrike", "OWASP ZAP",
                "Gobuster", "FFuF", "Dirb"
            ],
            "advantages": [
                "Simula ataque real",
                "Perspectiva del atacante",
                "Identifica exposición pública",
                "No requiere acceso interno"
            ],
            "limitations": [
                "Cobertura limitada",
                "No detecta vulnerabilidades internas",
                "Tiempo de ejecución más largo",
                "Puede generar falsos negativos"
            ]
        },
        "gray_box": {
            "name": "Caja Gris (Grey Box)",
            "description": "Prueba con conocimiento parcial del sistema. Simula amenaza interna o credenciales comprometidas.",
            "scope": "Acceso limitado con credenciales de usuario estándar. Información parcial del sistema.",
            "access_level": "Usuario estándar - Credenciales limitadas",
            "estimated_time": "1-3 semanas",
            "difficulty": "media",
            "phases": [
                "reconnaissance",
                "authenticated_scanning",
                "authorization_testing",
                "privilege_escalation",
                "lateral_movement",
                "data_exfiltration",
                "reporting"
            ],
            "tools": [
                "Nmap (authenticated)", "BloodHound", "PowerView",
                "LinPEAS", "WinPEAS", "Mimikatz",
                "CrackMapExec", "Evil-WinRM", "Impacket",
                "Burp Suite (authenticated)", "OWASP ZAP (sessions)",
                "Hydra", "Medusa", "John the Ripper"
            ],
            "advantages": [
                "Mayor cobertura que caja negra",
                "Identifica vulnerabilidades de autorización",
                "Pruebas de escalación de privilegios",
                "Simula amenaza interna realista"
            ],
            "limitations": [
                "Requiere credenciales iniciales",
                "No cubre todas las perspectivas externas",
                "Puede pasar por alto controles de acceso",
                "Tiempo variable según acceso"
            ]
        },
        "white_box": {
            "name": "Caja Blanca (White Box)",
            "description": "Prueba con conocimiento completo del sistema. Incluye código fuente, arquitectura y documentación.",
            "scope": "Acceso completo al código fuente, documentación técnica, arquitectura y credenciales.",
            "access_level": "Administrador - Acceso completo",
            "estimated_time": "2-6 semanas",
            "difficulty": "alta",
            "phases": [
                "architecture_review",
                "code_review",
                "static_analysis",
                "dependency_analysis",
                "configuration_review",
                "dynamic_testing",
                "threat_modeling",
                "reporting"
            ],
            "tools": [
                "Semgrep", "Bandit", "SonarQube",
                "OWASP Dependency-Check", "pip-audit", "npm audit",
                "TruffleHog", "GitLeaks", "detect-secrets",
                "Checkov", "Trivy", "Snyk",
                "ESLint", "Pylint", "RuboCop",
                "Retire.js", "Safety", "Bundle Audit"
            ],
            "advantages": [
                "Cobertura completa del sistema",
                "Identifica vulnerabilidades de diseño",
                "Análisis profundo de código",
                "Detección de vulnerabilidades ocultas",
                "Mejora la calidad del código"
            ],
            "limitations": [
                "Requiere acceso completo",
                "Mayor tiempo de ejecución",
                "Requiere expertise técnico avanzado",
                "No simula ataque real",
                "Puede generar muchos falsos positivos"
            ]
        },
        "red_team": {
            "name": "Red Team",
            "description": "Simulación de ataque adversario completo. Objetivo: comprometer la organización usando cualquier medio.",
            "scope": "Sin restricciones. Cualquier vector de ataque disponible (técnico, físico, social).",
            "access_level": "Ninguno inicialmente - Adquirido durante la operación",
            "estimated_time": "4-12 semanas",
            "difficulty": "muy_alta",
            "phases": [
                "reconnaissance",
                "weaponization",
                "delivery",
                "exploitation",
                "installation",
                "command_and_control",
                "actions_on_objectives",
                "reporting"
            ],
            "tools": [
                "Metasploit Framework", "Cobalt Strike", "Empire",
                "Social Engineering Toolkit (SET)", "GoPhish",
                "BloodHound", "Mimikatz", "Rubeus",
                "Covenant", "Sliver", "Mythic",
                "Responder", "Impacket", "CrackMapExec",
                "Proxychains", "Chisel", "ligolo-ng"
            ],
            "advantages": [
                "Simula ataque APT realista",
                "Evalúa capacidad de detección",
                "Prueba respuesta a incidentes",
                "Identifica cadenas de ataque completas",
                "Evalúa defensa en profundidad"
            ],
            "limitations": [
                "Muy costoso en tiempo/recursos",
                "Requiere equipo especializado",
                "Puede ser disruptivo",
                "Requiere coordinación extensa",
                "No cubre todas las vulnerabilidades"
            ]
        }
    }


