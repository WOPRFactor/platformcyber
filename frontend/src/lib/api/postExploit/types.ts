/**
 * Tipos para el módulo de Post-Explotación - Herramientas Específicas
 */

export interface BasePostExploitResult {
  success: boolean
  scan_id: number
  tool: string
  output_file?: string
  error?: string
  timestamp: string
}

export interface LinPEASResult extends BasePostExploitResult {
  target: string
  local: boolean
  findings: {
    kernel_info?: string
    users_info?: string
    sudo_info?: string
    capabilities?: string[]
    cron_jobs?: string[]
    network_info?: string
    interesting_files?: string[]
  }
}

export interface WinPEASResult extends BasePostExploitResult {
  target: string
  local: boolean
  username?: string
  findings: {
    system_info?: string
    users_info?: string
    network_info?: string
    credentials?: string[]
    interesting_files?: string[]
    services?: string[]
  }
}

export interface BloodHoundResult extends BasePostExploitResult {
  domain: string
  collection_method: string
  username: string
  dc_ip?: string
  data_collected: {
    users?: number
    groups?: number
    computers?: number
    relationships?: number
  }
  zip_file?: string
}

export interface MimikatzResult extends BasePostExploitResult {
  target: string
  username: string
  command: string
  credentials: {
    username?: string
    password?: string
    domain?: string
    lm_hash?: string
    nt_hash?: string
  }[]
}

export interface PowerViewResult extends BasePostExploitResult {
  target: string
  username: string
  command: string
  results: any // Los resultados varían según el comando ejecutado
}

export interface SeatbeltResult extends BasePostExploitResult {
  target: string
  username: string
  group: string
  checks: {
    name: string
    status: string
    data?: any
  }[]
}

export interface LaZagneResult extends BasePostExploitResult {
  target: string
  mode: string
  passwords_found: {
    software: string
    username?: string
    password?: string
    url?: string
  }[]
}

export interface SSHPivotResult extends BasePostExploitResult {
  jump_host: string
  jump_user: string
  remote_host: string
  remote_port: number
  local_port: number
  tunnel_active: boolean
  pid?: number
}

export interface ChiselResult extends BasePostExploitResult {
  attacker_host: string
  attacker_port: number
  remote_host: string
  remote_port: number
  bind_port: number
  tunnel_active: boolean
  pid?: number
}

export interface LigoloResult extends BasePostExploitResult {
  relay_port: number
  agent_port: number
  target_subnet: string
  tunnel_active: boolean
  pid?: number
}

export interface PostExploitSession {
  id: number
  session_id: string
  target: string
  scan_type: string
  created_at: string
  status: string
}

export interface LinPEASRequest {
  target: string
  workspace_id: number
  local?: boolean
  ssh_user?: string
  ssh_pass?: string
}

export interface WinPEASRequest {
  target: string
  workspace_id: number
  local?: boolean
  username?: string
  password?: string
}

export interface BloodHoundRequest {
  domain: string
  workspace_id: number
  username: string
  password: string
  collection_method?: string
  dc_ip?: string
}

export interface MimikatzRequest {
  target: string
  workspace_id: number
  username: string
  password: string
  command?: string
}

export interface PowerViewRequest {
  target: string
  workspace_id: number
  username: string
  password: string
  command?: string
}

export interface SeatbeltRequest {
  target: string
  workspace_id: number
  username: string
  password: string
  group?: string
}

export interface LaZagneRequest {
  target: string
  workspace_id: number
  mode?: string
}

export interface SSHPivotRequest {
  workspace_id: number
  jump_host: string
  jump_user: string
  remote_host: string
  remote_port: number
  local_port: number
}

export interface ChiselRequest {
  workspace_id: number
  attacker_host: string
  attacker_port: number
  remote_host: string
  remote_port: number
  bind_port: number
}

export interface LigoloRequest {
  workspace_id: number
  relay_port: number
  agent_port: number
  target_subnet: string
}



